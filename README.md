# ODPS Software Distribution

[![Build Status](https://travis-ci.org/aliyun/aliyun-odps-software-dist.svg)](https://travis-ci.org/aliyun/aliyun-odps-software-dist)

Everything(docs, packaging recipes, and scripts...) we needed to generate [http://repo.aliyun.com](http://repo.aliyun.com).



## Package!


Use the following command to package a **RPM** and a **DEB** package for [odpscmd](https://github.com/aliyun/aliyun-odps-console), repectively.


```
make odpscmd.rpm && make odpscmd.deb
```

The packages are generated by [fpm-cookery](https://github.com/bernd/fpm-cookery) and [rpmbuild](http://rpm.org). So you have to intall them on your machine first.

### fpm-cookery

[fpm-cookery](https://github.com/bernd/fpm-cookery
) is a Ruby-DSL wrapper around [fpm](https://github.com/jordansissel/fpm). It can be easily installed with gem: 

```
gem install fpm-cookery
```

### rpmbuild 

- If you are in a rpm based Linux distribution like RHEL or CentOS, you are good.
- Install `rpmbuild` into your packaging OS thourgh its own package system, eg.
  - ArchLinux: `yaourt -S rpm-org`
  - Mac OS: `brew install rpm`
- Visit [http://rpm.org](http://rpm.org) to obtain the source package and deploy it manually.



## Deploy!

### Deploy the Repositories

The apt and yum repos are supposed be under `/apt/debian` and `/yum/rpm`, respectively.
 

```
make deploy
```


### Deploy the Web Page

After typing the following command, the docs will be automatically generated and update to [http://repo.aliyun.com](http://repo.aliyun.com).

```
make deploy-web
```

The python script `auto_deploy.py` can be used (e.g. with a web hooker) to update the web page.

## Edit Templates

When you need to add some stuff into the template, just edit the template in the "site-packages" directory (for some installations, the directory is "dist-packages").
